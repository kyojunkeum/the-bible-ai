# 인용 검증 로직

## 1) DB 기반 원문 검증

`api/main.py`의 `_verify_citations()`에서 절 단위로 DB를 조회해
요청된 본문 텍스트가 DB와 완전히 일치하는지 확인합니다.

- 일치하지 않는 인용은 제거합니다.
- DB에 없는 절은 무시합니다.

## 2) 응답 문자열 정합성 보정

`api/chat.py`의 `enforce_exact_citations()`는 다음을 보장합니다.

- 응답 문자열에 인용 본문이 누락되었거나 변형된 경우,
  인용 블록을 올바른 본문으로 교체 또는 추가합니다.
- 인용 블록 포맷:
  ```
  (책이름 장:절) 본문
  ```

## 3) 최종 흐름

1. 검색/조회로 인용 후보 생성
2. DB 원문 검증 (`_verify_citations`)
3. 응답 문자열에 정확한 본문 삽입 (`enforce_exact_citations`)
